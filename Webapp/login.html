<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Planner - Login</title>

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
          integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="css/login.css">

    <!-- JQuery JS CDN -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    
            <!-- Cookies Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    
    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
            integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ"
            crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
            integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY"
            crossorigin="anonymous"></script>
    <script>
        $(document).ready(function(){
            $("#btn-submit").click(function(event){
                event.preventDefault();
                let email = $("#inputEmail").val().trim();
                let password = $("#inputPassword").val().trim();
                let remeber = $('#checkbox').is(':checked');
                let url = "http://localhost:1080/login";

                if( email != "" && password != "" ){
                    $.ajax({
                        url: url,
                        type:'post',
                        data:{
                            email:email,
                            password:password
                        },
                        success:function(response){
                            response = JSON.parse(response);
                            console.log(response);
                            if(response.access === true){
                                //set Cookies
                                Cookies.set('sessionId', response.sessionId);
                                Cookies.set('userId', response.userId);
                                //redirect to index
                                //window.location = "/";
                            }else{
                                $("#errMsg").text("Wrong e-mail or password.");
                                $("#alertDanger").toggle();
                            }
                        }
                    });
                }
            });
        });
    </script>
</head>
<body class="text-center">
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <h1 style="text-align: center; width: 100%;">
            Planner - Login
        </h1>
    </div>
</nav>
<div class="alert danger" id="alertDanger" style="display: none;">
    <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
    <span id="errMsg"></span>
</div>
<div class="flex">
    <form class="form-signin">
        <img class="mb-4" src="img/logo.png" width="125px" height="125px">
        <label for="inputEmail" class="sr-only">Email address</label>
        <input type="email" id="inputEmail" class="form-control" placeholder="Email address" required autofocus name="email">
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="inputPassword" class="form-control" placeholder="Password" required name="password">
         <div class="checkbox mb-3">
            <label>
                <input type="checkbox" value="remember-me" id="checkbox"> Remember me
            </label>
        </div>
        <button class="btn btn-lg btn-primary btn-block" id="btn-submit">Sign in</button>
        <p class="mt-5 mb-3 text-muted">&copy; 2017-2018</p>
    </form>
</div>
</body>
</div>
</html>
